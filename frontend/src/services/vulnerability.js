import { axiosInstance } from '../boot/axios'

export default {
  async getVulnerabilities() {
    return axiosInstance.get('vulnerabilities')
  },

  async exportVulnerabilities() {
    return axiosInstance.get('vulnerabilities/export')
  },

  async getVulnByLanguage(locale) {
    return axiosInstance.get(`vulnerabilities/${locale}`)
  },

  async createVulnerabilities(vulnerabilities) {
    return axiosInstance.post('vulnerabilities', vulnerabilities)
  },

  async deleteVulnerability(vulnerabilityId) {
    return axiosInstance.delete(`vulnerabilities/${vulnerabilityId}`)
  },

  async deleteAllVulnerabilities() {
    return axiosInstance.delete('vulnerabilities')
  },

  async updateVulnerability(vulnerabilityId, vulnerability) {
    return axiosInstance.put(`vulnerabilities/${vulnerabilityId}`, vulnerability)
  },

  async backupFinding(locale, finding) {
    return axiosInstance.post(`vulnerabilities/finding/${locale}`, finding)
  },

  async getVulnUpdates(vulnId) {
    return axiosInstance.get(`vulnerabilities/updates/${vulnId}`)
  },

  async mergeVulnerability(vulnIdLeft, vulnIdRight, locale) {
    return axiosInstance.put(`vulnerabilities/merge/${vulnIdLeft}`, { vulnId: vulnIdRight, locale })
  }
}